<div class="position-relative">
    <span *ngIf="loading" class="fs-6 loader">Please wait...
      <span class="spinner-border spinner-border-sm align-middle ms-2 " ></span>
  </span>
  <div class="pb-50">
    <label class="fs-6 fw-bold mb-2 text-uppercase text-primary">Payment Plan
        <i class="fas fa-exclamation-circle ms-2 fs-7" data-bs-toggle="tooltip" title="Select a discount type that will be applied to this product"></i></label>
        <div class="row row-cols-1 row-cols-md-3 row-cols-lg-1 row-cols-xl-3 g-9 mt-2" data-kt-buttons="true" data-kt-buttons-target="[data-kt-button='true']">
            <!--begin::Col-->
            <div class="col">
              <!--begin::Option-->
                <label class="form-label fs-6 text-uppercase fw-medium text-primary">Remaining Payments</label>
             <!--end::Label-->
             <!--begin::Input-->
            <div class="form-control mb-2 d-flex align-items-center bg-light-primary" >
              <span class="fs-5 fw-bolder  text-primary badge" > <span>{{noOfPaymentsDisplayed}}</span> </span>
            </div>
            <!--end::Input-->
        
              <!--end::Option-->
            </div>
            <!--end::Col-->
            <!--begin::Col-->
            <div class="col position-relative">
              <!--begin::Option-->
        
              <label class="form-label fs-6 text-uppercase fw-medium text-primary">Remaining Budget
        
              </label>
              <!--end::Label-->
              <!--begin::Input-->
             <div class="form-control mb-2 d-flex align-items-center bg-light-warning" [class.bg-light-danger]="showAlert" >
        
               <span class="fs-5 fw-bolder  text-gold badge" >$
        
                <span class="fs-5 fw-bolder " #BudgetTotalCounter [class.text-red]="showAlert">
        
              {{ totalBudgetDisplayed }}
              </span>
                 <!-- <span [class.text-red]="showAlert">{{totalBudgetDisplayed}}</span> -->
                 </span>
             </div>
        
              <!--end::Option-->
            </div>
            <!--end::Col-->
            <!--begin::Col-->
            <div class="col">
              <!--begin::Option-->
              <label class="form-label fs-6 text-uppercase fw-medium text-primary">Spent Budget</label>
              <!--end::Label-->
              <!--begin::Input-->
             <div class="form-control mb-2 d-flex align-items-center bg-light-danger" >
               <span class="fs-5 fw-bolder  text-red badge" >$
                <span class="fs-5 fw-bolder " #budgetSpentCounter >{{ budgetSpent }}</span>
              </span>
             </div>
        
        
              <!--end::Option-->
            </div>
            <!--end::Col-->
          </div>
          <div class="row row-cols-1 mt-3 " *ngIf="showAlert">
            <div class="notice d-flex justify-content-center bg-light-danger rounded border-danger border border-dashed mb-9 p-4">
              <!--begin::Icon-->
              <!--begin::Svg Icon | path: icons/duotune/general/gen044.svg-->
              <span class="svg-icon svg-icon-2tx svg-icon-danger me-4 m-auto">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                  <rect opacity="0.3" x="2" y="2" width="20" height="20" rx="10" fill="black" />
                  <rect x="11" y="14" width="7" height="2" rx="1" transform="rotate(-90 11 14)" fill="black" />
                  <rect x="11" y="17" width="2" height="2" rx="1" transform="rotate(-90 11 17)" fill="black" />
                </svg>
              </span>
              <!--end::Svg Icon-->
              <!--end::Icon-->
              <!--begin::Wrapper-->
              <div class="d-flex flex-stack flex-grow-1">
                <!--begin::Content-->
                <div class="fw-bold">
                  <h4 class="text-gray-900 fw-bolder fs-5">Budget Was Exceeded</h4>
                  <div class="fs-7 text-gray-700">Plese modity the precentage to meet the budget limit
                  <br />
                  </div>
                </div>
                <!--end::Content-->
              </div>
              <!--end::Wrapper-->
            </div>
          </div>
          <div class="row row-cols-1 mt-3 " *ngIf="emptyField">
            <div class="notice d-flex justify-content-center bg-light-danger rounded border-danger border border-dashed mb-9 p-4">
              <!--begin::Icon-->
              <!--begin::Svg Icon | path: icons/duotune/general/gen044.svg-->
              <span class="svg-icon svg-icon-2tx svg-icon-danger me-4 m-auto">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                  <rect opacity="0.3" x="2" y="2" width="20" height="20" rx="10" fill="black" />
                  <rect x="11" y="14" width="7" height="2" rx="1" transform="rotate(-90 11 14)" fill="black" />
                  <rect x="11" y="17" width="2" height="2" rx="1" transform="rotate(-90 11 17)" fill="black" />
                </svg>
              </span>
              <!--end::Svg Icon-->
              <!--end::Icon-->
              <!--begin::Wrapper-->
              <div class="d-flex flex-stack flex-grow-1">
                <!--begin::Content-->
                <div class="fw-bold">
                  <h4 class="text-gray-900 fw-bolder fs-5">Some Payment Are Empty</h4>
                  <div class="fs-7 text-gray-700">Please fill all the payments with a valid percentage
                  <br />
                  </div>
                </div>
                <!--end::Content-->
              </div>
              <!--end::Wrapper-->
            </div>
          </div>
          <div class="row row-cols-1 mt-3 " *ngIf="remainBudget">
            <div class="notice d-flex justify-content-center bg-light-danger rounded border-danger border border-dashed mb-9 p-4">
              <!--begin::Icon-->
              <!--begin::Svg Icon | path: icons/duotune/general/gen044.svg-->
              <span class="svg-icon svg-icon-2tx svg-icon-danger me-4 m-auto">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                  <rect opacity="0.3" x="2" y="2" width="20" height="20" rx="10" fill="black" />
                  <rect x="11" y="14" width="7" height="2" rx="1" transform="rotate(-90 11 14)" fill="black" />
                  <rect x="11" y="17" width="2" height="2" rx="1" transform="rotate(-90 11 17)" fill="black" />
                </svg>
              </span>
              <!--end::Svg Icon-->
              <!--end::Icon-->
              <!--begin::Wrapper-->
              <div class="d-flex flex-stack flex-grow-1">
                <!--begin::Content-->
                <div class="fw-bold">
                  <h4 class="text-gray-900 fw-bolder fs-5">There Still Budget To Spend</h4>
                  <div class="fs-7 text-gray-700">Please spend all the budget with a valid percentage
                  <br />
                  </div>
                </div>
                <!--end::Content-->
              </div>
              <!--end::Wrapper-->
            </div>
          </div>
          <div class="row row-cols-1 row-cols-md-1 row-cols-xl-2 g-9 mt-10">
            <div class="col">
              <div class="mat-elevation-z8 table-container w-100" >
                <table mat-table [dataSource]="dataSource" matSort>
                  <!-- Payment Column -->
                  <ng-container matColumnDef="payment">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header class="text-uppercase" style="width: 130px;"> Payment No. </th>
                    <td mat-cell *matCellDef="let row">{{row.paymentNo}}</td>
                  </ng-container>
                  <ng-container matColumnDef="percentage">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header class="text-uppercase" > Percentage (%) </th>
                    <td mat-cell *matCellDef="let row">
                      <input type="text" mdInput class="percentage-input text-gray-800 fw-bold" [(ngModel)]="row.percentage"  (input)="onPercentageInput(row)" min="0" max="100"  maxlength="3">
                      <div class="fv-plugins-message-container invalid-feedback pb-2"
                      *ngIf="!row.isValid">Please Enter A Valid number</div>
                  </td>
        
                  </ng-container>
                  <!-- Percentage Input Column -->
        
        
                  <!-- Amount Column -->
                  <ng-container matColumnDef="amount">
                    <th mat-header-cell *matHeaderCellDef class="text-uppercase" mat-sort-header > Amount </th>
                    <td mat-cell *matCellDef="let row">{{row.amount | currency}}</td>
                  </ng-container>
        
                  <!-- ... More columns ... -->
        
                  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                  <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        
                  <!-- <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell" colspan="4">No data matching the filter "{{input.value}}"</td>
                  </tr> -->
                </table>
              </div>
            </div>
        
        
            <div class="col position-relative">
              <div class="popup bg-light-success text-green"  [class.show]="showPopup" [@fadeInOut]>
                +{{percentagePreview}}%
              </div>
        
              <app-counter-chart
              class="card card-xl-stretch mb-xl-8"
              [chartColor]="displayedPercentage <100 ? '#0778b9' : (displayedPercentage === 100 ? '#4fdf1e' : '#cf0e0e')"
              chartHeight="200px"
              [chartPercentage]="displayedPercentage"
              ></app-counter-chart>
            </div>
        
          </div>
  </div>
  
  </div>
  